<script>
  const USERS = {
    "client1": "indian123",
    "client2": "indian321",
    "planetimpex": "planet123"
  };

  const baseSheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR1a3OFd1Xh5WebntRT3Y8kUX7H8TtkwlzoWqF8W4trBr5Rkd3rADcJZDOI6c0w9mAgvplBHlhOfZR1/pubhtml?widget=true&headers=false&chrome=false';

  function showLoading() {
    document.getElementById("loading").style.display = "flex";
  }

  function hideLoading() {
    document.getElementById("loading").style.display = "none";
  }

  function loadSheet() {
    showLoading();
    const iframe = document.getElementById("sheetFrame");
    iframe.src = baseSheetURL + '&t=' + new Date().getTime(); // cache-bust
  }

  function checkLogin() {
    const user = document.getElementById("username").value.trim();
    const pass = document.getElementById("password").value.trim();
    if (USERS[user] === pass) {
      localStorage.setItem("loggedIn", "yes");
      localStorage.setItem("user", user);
      showProtected();
    } else {
      document.getElementById("login-error").innerText = "Invalid login";
    }
  }

  function showProtected() {
    document.getElementById("login").style.display = "none";
    document.getElementById("protected").style.display = "block";
    loadSheet();
    setInterval(loadSheet, 60000); // refresh every 60s
  }

  window.onload = function () {
    if (localStorage.getItem("loggedIn") === "yes") {
      showProtected();
    } else {
      document.getElementById("login").style.display = "flex";
    }
  };
</script>
