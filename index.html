<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Live Sheet Dashboard</title>

<style>

html,body{
margin:0;
padding:0;
width:100%;
height:100%;
font-family:Arial;
overflow:hidden;
}

#login,#protected{
width:100%;
height:100%;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
}

input,button{
padding:10px;
margin:6px;
font-size:16px;
}

#protected{
position:relative;
overflow:hidden;
}

/* FULL SCREEN SHEET */

iframe{
width:100vw;
height:100vh;
border:none;
}

/* LOADING */

#loading{
position:absolute;
width:100%;
height:100%;
background:white;
z-index:10;
display:flex;
justify-content:center;
align-items:center;
font-size:20px;
}

</style>
</head>

<body>

<div id="login" style="display:none;">
<h2>Client Login</h2>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<button onclick="checkLogin()">Login</button>
<p id="login-error" style="color:red;"></p>
</div>

<div id="protected" style="display:none;">
<div id="loading">Loading dashboard...</div>
<iframe id="sheetFrame"></iframe>
</div>

<script>

/* VERSION */
const LOGIN_VERSION="v4";

/* USERS */
const USERS={
"client11":"planet2026",
"client4":"planet2026",
"planetimpexindia":"planet2026"
};

/* SHEET */
const baseSheetURL="https://docs.google.com/spreadsheets/d/e/2PACX-1vR1a3OFd1Xh5WebntRT3Y8kUX7H8TtkwlzoWqF8W4trBr5Rkd3rADcJZDOI6c0w9mAgvplBHlhOfZR1/pubhtml?widget=true&headers=false&chrome=false";

/* LOAD */

function loadSheet(){

const iframe=document.getElementById("sheetFrame");
document.getElementById("loading").style.display="flex";

const ni=iframe.cloneNode();
ni.id="sheetFrame";

ni.onload=()=>{
document.getElementById("loading").style.display="none";
};

ni.src=baseSheetURL+"&t="+Date.now();
iframe.parentNode.replaceChild(ni,iframe);
}

/* LOGIN */

function checkLogin(){

const u=username.value.trim();
const p=password.value.trim();

if(USERS[u]===p){

localStorage.setItem("loggedIn","yes");
localStorage.setItem("loginVersion",LOGIN_VERSION);
showProtected();

}else{
document.getElementById("login-error").innerText="Invalid login";
}
}

/* SHOW */

function showProtected(){

login.style.display="none";
protected.style.display="flex";

loadSheet();
setInterval(loadSheet,60000);
}

/* AUTO LOGIN */

window.onload=()=>{

if(localStorage.getItem("loggedIn")==="yes" &&
localStorage.getItem("loginVersion")===LOGIN_VERSION){

showProtected();

}else{
localStorage.clear();
login.style.display="flex";
}
};

</script>

</body>
</html>
