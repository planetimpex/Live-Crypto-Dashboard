<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>Live Sheet Dashboard</title>

<style>

html,body{
margin:0;
padding:0;
height:100%;
overflow:hidden;
font-family:Arial;
}

#login,#protected{
width:100vw;
height:100vh;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
}

input,button{
padding:10px;
margin:6px;
font-size:16px;
}

#protected{
position:relative;
overflow:hidden;
}

/* container */
#frameWrap{
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
display:flex;
justify-content:center;
align-items:center;
overflow:hidden;
}

/* iframe */
iframe{
border:none;
transform-origin:top left;
}

/* loading */
#loading{
position:absolute;
width:100%;
height:100%;
background:white;
z-index:10;
display:flex;
justify-content:center;
align-items:center;
font-size:20px;
}

</style>
</head>

<body>

<div id="login" style="display:none;">
<h2>Client Login</h2>
<input id="username" placeholder="Username">
<input id="password" type="password" placeholder="Password">
<button onclick="checkLogin()">Login</button>
<p id="login-error" style="color:red;"></p>
</div>

<div id="protected" style="display:none;">
<div id="loading">Loading dashboard...</div>

<div id="frameWrap">
<iframe id="sheetFrame"></iframe>
</div>

</div>

<script>

/* VERSION */
const LOGIN_VERSION="v4";

/* USERS */
const USERS={
"client11":"planet2026",
"client4":"planet2026",
"planetimpexindia":"planet2026"
};

/* SHEET */
const baseSheetURL="https://docs.google.com/spreadsheets/d/e/2PACX-1vR1a3OFd1Xh5WebntRT3Y8kUX7H8TtkwlzoWqF8W4trBr5Rkd3rADcJZDOI6c0w9mAgvplBHlhOfZR1/pubhtml?widget=true&headers=false&chrome=false";

/* LOAD */

function loadSheet(){

const iframe=document.getElementById("sheetFrame");
document.getElementById("loading").style.display="flex";

const ni=iframe.cloneNode();
ni.id="sheetFrame";

ni.onload=()=>{
fitFrame();
document.getElementById("loading").style.display="none";
};

ni.src=baseSheetURL+"&t="+Date.now();
iframe.parentNode.replaceChild(ni,iframe);
}

/* PERFECT AUTO FIT */

function fitFrame(){

const iframe=document.getElementById("sheetFrame");

/* REAL dashboard size guess (large so everything fits) */
const sheetW=3000;
const sheetH=2000;

iframe.style.width=sheetW+"px";
iframe.style.height=sheetH+"px";

const sw=window.innerWidth;
const sh=window.innerHeight;

const scale=Math.min(sw/sheetW,sh/sheetH);

iframe.style.transform=`scale(${scale})`;
}

/* LOGIN */

function checkLogin(){

const u=username.value.trim();
const p=password.value.trim();

if(USERS[u]===p){

localStorage.setItem("loggedIn","yes");
localStorage.setItem("loginVersion",LOGIN_VERSION);

showProtected();

}else{
document.getElementById("login-error").innerText="Invalid login";
}
}

/* SHOW */

function showProtected(){

login.style.display="none";
protected.style.display="flex";

loadSheet();
setInterval(loadSheet,60000);
}

/* AUTO */

window.onload=()=>{

if(localStorage.getItem("loggedIn")==="yes" &&
localStorage.getItem("loginVersion")===LOGIN_VERSION){

showProtected();

}else{
localStorage.clear();
login.style.display="flex";
}
};

/* RESIZE FIX */

window.addEventListener("resize",()=>setTimeout(fitFrame,300));

</script>

</body>
</html>
